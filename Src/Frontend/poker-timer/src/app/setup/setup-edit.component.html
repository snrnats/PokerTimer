<form *ngIf="form; else loading" [formGroup]="form" (ngSubmit)="submit()" class="content-container">
    <mat-form-field class="fullWidth">
        <input matInput type="text" placeholder="Title" formControlName="title" />
    </mat-form-field>

    <mat-form-field style="width: 48%;margin-right:2%">
        <input matInput type="number" placeholder="Starting chips" formControlName="startingChips" />
    </mat-form-field>

    <mat-form-field style="width: 48%; margin-left: 2%">
        <input matInput type="number" placeholder="Number of players" formControlName="numberOfPlayers" />
    </mat-form-field>

    <mat-checkbox formControlName="isInfinite">Is infinite</mat-checkbox>

    <mat-form-field *ngIf="form.value.isInfinite" style="display: block;margin-top: 12px">
        <input matInput type="number" placeholder="Blind multiplier" formControlName="numberOfPlayers" />
    </mat-form-field>

    <p class="mat-title" style="margin-top: 2em">Levels
        <button type="button" mat-icon-button (click)="addLevel()" color="accent">
            <mat-icon>add</mat-icon>
        </button>
    </p>

    <table *ngIf="levels.length > 0" mat-table style="margin: 0em -1.2em" [dataSource]="levels" formArrayName="levels">
        <ng-container matColumnDef="title">
            <th mat-header-cell *matHeaderCellDef> Index </th>
            <td mat-cell *matCellDef="let element; let m = index"> {{m}} </td>
        </ng-container>

        <ng-container matColumnDef="smallBlind">
            <th mat-header-cell *matHeaderCellDef> Small blind </th>
            <td mat-cell *matCellDef="let element; let i = index" [formGroupName]="i">
                <input matInput type='text' formControlName="smallBlind">
            </td>
        </ng-container>

        <ng-container matColumnDef="bigBlind">
            <th mat-header-cell *matHeaderCellDef> Big blind </th>
            <td mat-cell *matCellDef="let element; let i = index" [formGroupName]="i">
                <input matInput type='text' formControlName="bigBlind">
            </td>
        </ng-container>

        <ng-container matColumnDef="ante">
            <th mat-header-cell *matHeaderCellDef> Ante </th>
            <td mat-cell *matCellDef="let element; let i = index" [formGroupName]="i">
                <input matInput type='text' formControlName="ante">
            </td>
        </ng-container>

        <ng-container matColumnDef="duration">
            <th mat-header-cell *matHeaderCellDef> Duration </th>
            <td mat-cell *matCellDef="let element; let i = index" [formGroupName]="i">
                <input matInput type='text' formControlName="duration">
            </td>
        </ng-container>

        <ng-container matColumnDef="actions">
            <th mat-header-cell *matHeaderCellDef></th>
            <td mat-cell *matCellDef="let element; let i = index">
                <button type="button" mat-icon-button (click)="removeLevel(i)">
                    <mat-icon>delete</mat-icon>
                </button>
            </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
    </table>

    <button mat-raised-button style="display: block" color="primary" type="submit" [disabled]="!form.valid">Save</button>
</form>
<ng-template #loading>
    <mat-spinner class="center-horizontal"></mat-spinner>
</ng-template>