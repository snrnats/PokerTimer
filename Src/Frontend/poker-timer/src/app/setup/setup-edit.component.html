<form *ngIf="form; else loading" [formGroup]="form" (ngSubmit)="submit()" class="content-container">
    <mat-form-field class="fullWidth">
        <input matInput type="text" placeholder="Title" formControlName="title" />
    </mat-form-field>

    <mat-form-field style="width: 48%;margin-right:2%">
        <input matInput type="number" placeholder="Starting chips" formControlName="startingChips" />
    </mat-form-field>

    <mat-form-field style="width: 48%; margin-left: 2%">
        <input matInput type="number" placeholder="Number of players" formControlName="numberOfPlayers" />
    </mat-form-field>

    <mat-checkbox formControlName="isInfinite">Is infinite</mat-checkbox>

    <mat-form-field *ngIf="form.value.isInfinite" style="display: block;margin-top: 12px">
        <input matInput type="number" placeholder="Blind multiplier" formControlName="numberOfPlayers" />
    </mat-form-field>

    <p class="mat-title" style="margin-top: 24px">Levels
        <button type="button" mat-icon-button (click)="onAdded()" color="accent">
            <mat-icon>add</mat-icon>
        </button>
    </p>


    <table class="mat-table" formArrayName="levels">
        <thead>
            <tr class="mat-header-row">
                <th class="mat-header-cell"> Index </th>
                <th class="mat-header-cell"> Small blind </th>
                <th class="mat-header-cell"> Big blind </th>
                <th class="mat-header-cell"> Ante </th>
                <th class="mat-header-cell"> Duration </th>
            </tr>
        </thead>
        <tbody>
            <tr class="mat-row" *ngFor="let level of levels.controls; let i = index" [formGroupName]="i">
                <td class="mat-cell"> {{i+1}} </td>
                <td class="mat-cell">
                    <mat-form-field>
                        <input matInput type='text' formControlName="smallBlind">
                    </mat-form-field>
                </td>
                <td class="mat-cell">
                    <mat-form-field>
                        <input matInput type='text' formControlName="bigBlind">
                    </mat-form-field>
                </td>
                <td class="mat-cell">
                    <mat-form-field>
                        <input matInput type='text' formControlName="ante">
                    </mat-form-field>

                </td>
                <td class="mat-cell">
                    <mat-form-field>
                        <input matInput type='text' formControlName="duration">
                    </mat-form-field>
                </td>

                <td class="mat-cell">
                    <button type="button" mat-icon-button (click)="removeLevel(i)">
                        <mat-icon>delete</mat-icon>
                    </button>
                </td>
            </tr>
        </tbody>
        <!--<ng-container matColumnDef="title">
                <th mat-header-cell *matHeaderCellDef > Index </th>
                <td mat-cell *matCellDef="let element; let m = i"> {{m}} </td>
            </ng-container>
        
            <ng-container matColumnDef="smallBlind">
                <th mat-header-cell *matHeaderCellDef > Small blind </th>
                <td mat-cell *matCellDef="let element"> {{element.smallBlind}} </td>
            </ng-container>
        
            <ng-container matColumnDef="bigBlind">
                <th mat-header-cell *matHeaderCellDef > Big blind </th>
                <td mat-cell *matCellDef="let element"> {{element.bigBlind}} </td>
            </ng-container>
        
            <ng-container matColumnDef="ante">
                <th mat-header-cell *matHeaderCellDef > Duration </th>
                <td mat-cell *matCellDef="let element"> {{element.ante}} </td>
            </ng-container>
        
            <ng-container matColumnDef="duration">
                <th mat-header-cell *matHeaderCellDef > Duration </th>
                <td mat-cell *matCellDef="let element"> {{element.duration}} </td>
            </ng-container>
        
            <ng-container matColumnDef="actions">
                <th mat-header-cell *matHeaderCellDef mat-sort-header></th>
                <td mat-cell *matCellDef="let element">
                    <button mat-icon-button [matMenuTriggerFor]="menu">
                        <mat-icon>more_vert</mat-icon>
                    </button>
                    <mat-menu #menu="matMenu">
                        <button mat-menu-item (click)="delete(element)">
                            <mat-icon>delete</mat-icon>
                            <span>Delete</span>
                        </button>
                    </mat-menu>
                </td>
            </ng-container>
        
            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;let i = index"></tr>-->
    </table>


    <!--<mat-accordion formArrayName="levels">
        <mat-expansion-panel *ngFor="let level of levels.controls; let i=index" [formGroupName]="i">
            <mat-expansion-panel-header>
                <mat-panel-title>
                    Level {{i+1}}
                </mat-panel-title>
            </mat-expansion-panel-header>

            <mat-form-field>
                <input matInput type="number" placeholder="Duration" formControlName="duration">
            </mat-form-field>

            <mat-form-field>
                <input matInput type="number" placeholder="Small blind" formControlName="smallBlind">
            </mat-form-field>

            <mat-form-field>
                <input matInput type="number" placeholder="Big blind" formControlName="bigBlind">
            </mat-form-field>

            <mat-form-field>
                <input matInput type="number" placeholder="ante" formControlName="ante">
            </mat-form-field>

            <mat-action-row>
                <button mat-button color="primary" (click)="removeLevel(i)">Remove</button>
            </mat-action-row>
        </mat-expansion-panel>
    </mat-accordion>-->

    <button mat-raised-button style="display: block" color="primary" type="submit" [disabled]="!form.valid">Save</button>
</form>
<ng-template #loading>
    <mat-spinner class="center-horizontal"></mat-spinner>
</ng-template>